<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1434px" preserveAspectRatio="none" style="width:1342px;height:1434px;background:#00000000;" version="1.1" viewBox="0 0 1342 1434" width="1342.8px" zoomAndPan="magnify"><defs><filter height="300%" id="fhrrorurpr4m9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.4"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.8" dy="4.8" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter><linearGradient id="ghrrorurpr4m90" x1="0%" x2="100%" y1="0%" y2="100%"><stop offset="0%" stop-color="#FF0000"/><stop offset="100%" stop-color="#FFFF00"/></linearGradient><linearGradient id="ghrrorurpr4m91" x1="0%" x2="100%" y1="0%" y2="100%"><stop offset="0%" stop-color="#0000FF"/><stop offset="100%" stop-color="#FFFFFF"/></linearGradient></defs><g><!--MD5=[8d246cae1ccf67eca7a1cc42c84dd820]
cluster FindReplyModule--><path d="M154.8,129 L309.6,129 A7.2,7.2 0 0 1 314.4,133.8 L322.8,164.9625 L1323.6,164.9625 A4.8,4.8 0 0 1 1328.4,169.7625 L1328.4,1414.8 A4.8,4.8 0 0 1 1323.6,1419.6 L154.8,1419.6 A4.8,4.8 0 0 1 150,1414.8 L150,133.8 A4.8,4.8 0 0 1 154.8,129 " fill="#EEEEEE" filter="url(#fhrrorurpr4m9)" style="stroke: #033C73; stroke-width: 1.7999999999999998;"/><line style="stroke: #033C73; stroke-width: 1.7999999999999998;" x1="150" x2="322.8" y1="164.9625" y2="164.9625"/><text fill="#033C73" font-family="Verdana" font-size="14.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="145.2" x="160.8" y="150.7664">FindReplyModule</text><!--MD5=[fa66ffc8969e3bb00fdf02ebbafc856c]
cluster FindReplyModule_cfg--><rect fill="#EEEEEE" height="604.2" rx="4.8" ry="4.8" style="stroke: #444444; stroke-width: 2.4; stroke-dasharray: 7.0,7.0;" width="357.6" x="942" y="189"/><text fill="#444444" font-family="Verdana" font-size="14.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117.6" x="1062" y="210.7664">Docker Config</text><!--MD5=[c1d178f271b00b0e56a3fc4264397750]
cluster TestingInterface--><rect fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" height="288" rx="4.8" ry="4.8" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="302.4" x="610.8" y="267.6"/><path d="M770.4,268.8 L770.4,287.9625 L758.4,299.9625 L610.8,299.9625 " fill="none" style="stroke: #2683B9; stroke-width: 1.7999999999999998;"/><text fill="#2683B9" font-family="Verdana" font-size="14.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="135.6" x="620.4" y="288.1664">Internal Testing</text><!--MD5=[475d745c38d6d4a8cd520ef0ab5e7cb0]
cluster EntryPoint--><polygon fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" points="188.4,213.6,200.4,201.6,572.4,201.6,572.4,586.8,560.4,598.8,188.4,598.8,188.4,213.6" style="stroke: #E47833; stroke-width: 1.7999999999999998;"/><line style="stroke: #E47833; stroke-width: 1.7999999999999998;" x1="560.4" x2="571.2" y1="213.6" y2="202.8"/><line style="stroke: #E47833; stroke-width: 1.7999999999999998;" x1="188.4" x2="560.4" y1="213.6" y2="213.6"/><line style="stroke: #E47833; stroke-width: 1.7999999999999998;" x1="560.4" x2="560.4" y1="213.6" y2="598.8"/><text fill="#E47833" font-family="Verdana" font-size="14.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93.6" x="328.8" y="236.5664">Entry Point</text><text fill="#008080" font-family="Verdana" font-size="14.4" font-style="italic" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="121.2" x="277.8" y="253.3289">NB_INSTANCES</text><text fill="#E47833" font-family="Verdana" font-size="14.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="69.6" x="403.8" y="253.3289">Threads</text><!--MD5=[5a67b7ef1662e0e5eb1558fe4777d068]
cluster SearchBest--><rect fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" height="742.8" rx="4.8" ry="4.8" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="511.2" x="178.8" y="648"/><path d="M304.8,649.2 L304.8,668.3625 L292.8,680.3625 L178.8,680.3625 " fill="none" style="stroke: #2683B9; stroke-width: 1.7999999999999998;"/><text fill="#2683B9" font-family="Verdana" font-size="14.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="102" x="188.4" y="668.5664">Search Best</text><!--MD5=[27ef8fd0563cd6f6841e9e57f151cd84]
entity FindReplyModule_vars--><path d="M961.2,244.2 L961.2,610.7719 A4.8,4.8 0 0 0 966,615.5719 L1275.6,615.5719 A4.8,4.8 0 0 0 1280.4,610.7719 L1280.4,251.4 L1268.4,239.4 L966,239.4 A4.8,4.8 0 0 0 961.2,244.2 " fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" style="stroke: #868E96; stroke-width: 1.7999999999999998;"/><path d="M1268.4,239.4 L1268.4,246.6 A4.8,4.8 0 0 0 1273.2,251.4 L1280.4,251.4 " fill="#FFFFFF" style="stroke: #868E96; stroke-width: 1.7999999999999998;"/><text fill="#868E96" font-family="Verdana" font-size="14.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92.4" x="986.4" y="302.3227">Mandatory</text><text fill="#868E96" font-family="Verdana" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="50.4" x="986.4" y="328.8574">RMQ_IP:</text><text fill="#868E96" font-family="Verdana" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="69.6" x="1040.4" y="328.8574">RMQ broker</text><text fill="#868E96" font-family="Verdana" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="3.6" x="1110" y="328.8574">,</text><text fill="#868E96" font-family="Verdana" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="268.8" x="986.4" y="354.8262">QUESTIONS_QUEUE = Questions from RASA</text><text fill="#868E96" font-family="Verdana" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="78" x="986.4" y="380.7949">Ex: tbott-rpc.</text><text fill="#868E96" font-family="Verdana" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="51.6" x="1064.4" y="380.7949">dom.proj</text><text fill="#868E96" font-family="Verdana" font-size="13.2" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="66" x="986.4" y="407.8775">Optional</text><text fill="#868E96" font-family="Verdana" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="82.8" x="986.4" y="434.1293">RMQ_USER =</text><text fill="#868E96" font-family="Verdana" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="28.8" x="1072.8" y="434.1293">tbott</text><text fill="#868E96" font-family="Verdana" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="102" x="986.4" y="460.098">RMQ_PASSWD =</text><text fill="#868E96" font-family="Verdana" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="79.2" x="1092" y="460.098">M0m3n773ch</text><text fill="#868E96" font-family="Verdana" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="128.4" x="986.4" y="486.0668">ENCODER_QUEUE =</text><text fill="#868E96" font-family="Verdana" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="80.4" x="1118.4" y="486.0668">tbott-encoder</text><text fill="#868E96" font-family="Verdana" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="132" x="986.4" y="512.0355">MATCHING_QUEUE =</text><text fill="#868E96" font-family="Verdana" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="87.6" x="1122" y="512.0355">tbott-matching</text><text fill="#868E96" font-family="Verdana" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="109.2" x="986.4" y="538.0043">NB_INSTANCES =</text><text fill="#868E96" font-family="Verdana" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="7.2" x="1099.2" y="538.0043">5</text><text fill="#868E96" font-family="Verdana" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="80.4" x="986.4" y="563.973">RMQ_PORT =</text><text fill="#868E96" font-family="Verdana" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="28.8" x="1070.4" y="563.973">5672</text><text fill="#868E96" font-family="Verdana" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="81.6" x="986.4" y="589.9418">LOG_LEVEL=</text><text fill="#868E96" font-family="Verdana" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="30" x="1071.6" y="589.9418">INFO</text><line style="stroke: #868E96; stroke-width: 1.2;" x1="962.4" x2="1071" y1="267.1781" y2="267.1781"/><text fill="#868E96" font-family="Verdana" font-size="16.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="87.6" x="1077" y="272.3941">Variables</text><line style="stroke: #868E96; stroke-width: 1.2;" x1="1170.6" x2="1279.2" y1="267.1781" y2="267.1781"/><!--MD5=[ad43a35547d8f31748ef47d7c656d86d]
entity FindReplyModule_vols--><path d="M1017.6,692.4 L1017.6,769.125 A4.8,4.8 0 0 0 1022.4,773.925 L1219.2,773.925 A4.8,4.8 0 0 0 1224,769.125 L1224,699.6 L1212,687.6 L1022.4,687.6 A4.8,4.8 0 0 0 1017.6,692.4 " fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" style="stroke: #868E96; stroke-width: 1.7999999999999998;"/><path d="M1212,687.6 L1212,694.8 A4.8,4.8 0 0 0 1216.8,699.6 L1224,699.6 " fill="#FFFFFF" style="stroke: #868E96; stroke-width: 1.7999999999999998;"/><text fill="#868E96" font-family="Verdana" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27.6" x="1042.8" y="748.2949">logs</text><text fill="#868E96" font-family="Verdana" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="124.8" x="1074" y="748.2949">-&gt; /var/log/supervisor</text><line style="stroke: #868E96; stroke-width: 1.2;" x1="1018.8" x2="1074" y1="715.3781" y2="715.3781"/><text fill="#868E96" font-family="Verdana" font-size="16.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="81.6" x="1080" y="720.5941">Volumes</text><line style="stroke: #868E96; stroke-width: 1.2;" x1="1167.6" x2="1222.8" y1="715.3781" y2="715.3781"/><!--MD5=[cc34de39782346c444ab9ec26a286d1d]
entity MSG_T--><rect fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" height="218.175" rx="4.8" ry="4.8" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="264" x="630" y="318"/><rect fill="#FFFFFF" height="12" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="18" x="870" y="324"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="867.6" y="326.4"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="867.6" y="331.2"/><a href="http://10.165.64.205/AI/Messaging" target="_top" title="http://10.165.64.205/AI/Messaging" xlink:actuate="onRequest" xlink:href="http://10.165.64.205/AI/Messaging" xlink:show="new" xlink:title="http://10.165.64.205/AI/Messaging" xlink:type="simple"><text fill="#0000FF" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="80.4" x="654" y="361.3664">Messaging</text></a><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="16.8" x="739.2" y="361.3664">lib</text><line style="stroke: #2683B9; stroke-width: 1.2;" x1="631.2" x2="892.8" y1="370.7625" y2="370.7625"/><text fill="#008080" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="189.6" x="661.2" y="394.9289">zeromq.ThreadedWorker(</text><text fill="#008080" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="0" x="680.4" y="423.6914"/><text fill="#008080" font-family="Verdana" font-size="14.4" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="100.8" x="680.4" y="423.6914">callback_func</text><text fill="#008080" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="4.8" x="781.2" y="423.6914">,</text><text fill="#008080" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="76.8" x="680.4" y="452.4539">127.0.0.1,</text><text fill="#008080" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="0" x="680.4" y="481.2164"/><text fill="#008080" font-family="Verdana" font-size="14.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="48" x="680.4" y="481.2164">14002</text><text fill="#008080" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="0" x="680.4" y="509.9789"/><text fill="#008080" font-family="Verdana" font-size="14.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="680.4" y="509.9789">nb_workers=1</text><text fill="#008080" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="6" x="800.4" y="509.9789">)</text><!--MD5=[5b265eb2fd3f1a0aa329f1963cffe059]
entity MSG_C--><rect fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" height="285.3" rx="4.8" ry="4.8" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="308.4" x="234.6" y="284.4"/><rect fill="#FFFFFF" height="12" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="18" x="519" y="290.4"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="516.6" y="292.8"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="516.6" y="297.6"/><a href="http://10.165.64.205/AI/Messaging" target="_top" title="http://10.165.64.205/AI/Messaging" xlink:actuate="onRequest" xlink:href="http://10.165.64.205/AI/Messaging" xlink:show="new" xlink:title="http://10.165.64.205/AI/Messaging" xlink:type="simple"><text fill="#0000FF" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="80.4" x="258.6" y="327.7664">Messaging</text></a><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="16.8" x="343.8" y="327.7664">lib</text><line style="stroke: #2683B9; stroke-width: 1.2;" x1="235.8" x2="541.8" y1="337.1625" y2="337.1625"/><text fill="#008080" font-family="Verdana" font-size="14.4" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="152.4" x="265.8" y="361.3289">treaded_rpc.worker(</text><text fill="#008080" font-family="Verdana" font-size="14.4" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="45.6" x="265.8" y="390.0914">host=</text><text fill="#008080" font-family="Verdana" font-size="14.4" font-style="italic" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="69.6" x="311.4" y="390.0914">$RMQ_IP</text><text fill="#008080" font-family="Verdana" font-size="14.4" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="176.4" x="265.8" y="418.8539">username=$RMQ_USER</text><text fill="#008080" font-family="Verdana" font-size="14.4" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="195.6" x="265.8" y="447.6164">password=$RMQ_PASSWD</text><text fill="#008080" font-family="Verdana" font-size="14.4" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="234" x="265.8" y="476.3789">rpc_queue=$QUESTION_QUEUE</text><text fill="#008080" font-family="Verdana" font-size="14.4" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="136.8" x="265.8" y="505.1414">port=$RMQ_PORT)</text><line style="stroke: #2683B9; stroke-width: 1.2;" x1="235.8" x2="541.8" y1="519.3375" y2="519.3375"/><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="128.4" x="265.8" y="543.5039">on_request(msg)</text><!--MD5=[0b6da4d3acf42b1a006f10501b03f29a]
entity GetCtx--><rect fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" height="122.2875" rx="4.8" ry="4.8" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="372" x="229.2" y="825.6"/><rect fill="#FFFFFF" height="12" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="18" x="577.2" y="831.6"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="574.8" y="834"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="574.8" y="838.8"/><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="162" x="253.2" y="868.9664">if type == "question":</text><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="312" x="253.2" y="897.7289">&gt; get N1/N2 contexts @ 127.0.0.1:14001</text><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="165.6" x="253.2" y="926.4914">&gt; extend question list</text><!--MD5=[7be7f317a0ea0c634215121d8fef2d75]
entity GetVects--><rect fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" height="64.7625" rx="4.8" ry="4.8" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="309.6" x="260.4" y="974.4"/><rect fill="#FFFFFF" height="12" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="18" x="546" y="980.4"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="543.6" y="982.8"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="543.6" y="987.6"/><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="249.6" x="284.4" y="1017.7664">get vectors @ $ENCODER_QUEUE</text><!--MD5=[3cbeaa90f45d418792d3fe0131e2a8b6]
entity AskFaiss--><rect fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" height="93.525" rx="4.8" ry="4.8" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="435.6" x="197.4" y="1065.6"/><rect fill="#FFFFFF" height="12" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="18" x="609" y="1071.6"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="606.6" y="1074"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="606.6" y="1078.8"/><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="375.6" x="221.4" y="1108.9664">get candidates IDs from FAISS @ 127.0.0.1:14000</text><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="97.2" x="221.4" y="1137.7289">rearange IDs</text><!--MD5=[fe5f9f92828b1c2fccf346540a4e6477]
entity GetVectAdm--><rect fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" height="64.7625" rx="4.8" ry="4.8" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="392.4" x="219" y="1185.6"/><rect fill="#FFFFFF" height="12" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="18" x="587.4" y="1191.6"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="585" y="1194"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="585" y="1198.8"/><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="56.4" x="243" y="1228.9664">get IDs'</text><text fill="#2683B9" font-family="Verdana" font-size="14.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85.2" x="304.2" y="1228.9664">questions</text><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="28.8" x="394.2" y="1228.9664">and</text><text fill="#2683B9" font-family="Verdana" font-size="14.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="58.8" x="427.8" y="1228.9664">replies</text><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="84" x="491.4" y="1228.9664">from Admin</text><!--MD5=[c5a1ccf7239e9782fa8c48518b78c9ad]
entity getBestMatching--><rect fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" height="93.525" rx="4.8" ry="4.8" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="366" x="252.6" y="1278"/><rect fill="#FFFFFF" height="12" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="18" x="594.6" y="1284"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="592.2" y="1286.4"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="592.2" y="1291.2"/><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="207.6" x="276.6" y="1321.3664">create list of paired vectors</text><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="306" x="276.6" y="1350.1289">get best Matching @ $MATCHING_QUEUE</text><!--MD5=[b4655307bea1750bf10a3711aa3c6075]
entity RetBet--><rect fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" height="64.7625" rx="4.8" ry="4.8" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="145.2" x="525" y="698.4"/><rect fill="#FFFFFF" height="12" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="18" x="646.2" y="704.4"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="643.8" y="706.8"/><rect fill="#FFFFFF" height="2.4" style="stroke: #2683B9; stroke-width: 1.7999999999999998;" width="4.8" x="643.8" y="711.6"/><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="85.2" x="549" y="741.7664">return best</text><!--MD5=[165d55e2697f3381849a9a2b5cbc76bd]
entity FindReplyRMQ--><ellipse cx="67.2" cy="427.2" fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" rx="9.6" ry="9.6" style="stroke: #C71C22; stroke-width: 2.4;"/><text fill="#343A40" font-family="Verdana" font-size="14.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="88.8" x="22.8" y="466.9664">Start Here</text><!--MD5=[eede99d28d534b032ba9856d99f66a6c]
entity TestFindings--><ellipse cx="762" cy="53.4" fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" rx="9.6" ry="9.6" style="stroke: #C71C22; stroke-width: 2.4;"/><text fill="#343A40" font-family="Verdana" font-size="14.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73.2" x="725.4" y="93.1664">Testings</text><!--MD5=[65a15915d2cc54585b137278ef6b7e75]
entity Admin1--><ellipse cx="102" cy="872.4" fill="url(#ghrrorurpr4m90)" filter="url(#fhrrorurpr4m9)" rx="14.4" ry="14.4" style="stroke: #6F42C1; stroke-width: 2.4;"/><line style="stroke: #6F42C1; stroke-width: 2.4;" x1="87.6" x2="116.4" y1="889.2" y2="889.2"/><text fill="#000000" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="45.6" x="79.2" y="910.9664">Admin</text><!--MD5=[eee6185bd73f45d88be72cec907cd9c5]
entity Admin2--><ellipse cx="102" cy="1203.6" fill="url(#ghrrorurpr4m90)" filter="url(#fhrrorurpr4m9)" rx="14.4" ry="14.4" style="stroke: #6F42C1; stroke-width: 2.4;"/><line style="stroke: #6F42C1; stroke-width: 2.4;" x1="87.6" x2="116.4" y1="1220.4" y2="1220.4"/><text fill="#000000" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="45.6" x="79.2" y="1242.1664">Admin</text><!--MD5=[3ceae401b49d0ad0fe702da941d15e72]
entity Faiss--><ellipse cx="105.6" cy="1098" fill="url(#ghrrorurpr4m91)" filter="url(#fhrrorurpr4m9)" rx="14.4" ry="14.4" style="stroke: #6F42C1; stroke-width: 2.4;"/><line style="stroke: #6F42C1; stroke-width: 2.4;" x1="91.2" x2="120" y1="1114.8" y2="1114.8"/><text fill="#000000" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="38.4" x="86.4" y="1136.5664">Faiss</text><!--MD5=[577ee27765cb72cf7b02c80a46fe7b51]
entity Encoder--><ellipse cx="62.4" cy="992.4" fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" rx="14.4" ry="14.4" style="stroke: #2683B9; stroke-width: 2.4;"/><line style="stroke: #2683B9; stroke-width: 2.4;" x1="48" x2="76.8" y1="1009.2" y2="1009.2"/><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="98.4" x="13.2" y="1030.9664">Bert Encoder</text><!--MD5=[0b4846db015581273f652c6d394a5ede]
entity Matcher--><ellipse cx="68.4" cy="1296" fill="#FFFFFF" filter="url(#fhrrorurpr4m9)" rx="14.4" ry="14.4" style="stroke: #2683B9; stroke-width: 2.4;"/><line style="stroke: #2683B9; stroke-width: 2.4;" x1="54" x2="82.8" y1="1312.8" y2="1312.8"/><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="72" x="32.4" y="1334.5664">Sentence</text><text fill="#2683B9" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="68.4" x="32.4" y="1363.3289">Matching</text><!--MD5=[ce87164961160ef57e12dd1e6fb85888]
link FindReplyModule_vars to FindReplyModule_vols--><!--MD5=[0f1dfe5e38ae2459e96001a9059acb33]
link TestFindings to MSG_T--><path d="M762,78.936 C762,78.936 762,222.42 762,302.1552 " fill="none" id="TestFindings-MSG_T" style="stroke: #73A839; stroke-width: 3.0;"/><polygon fill="#73A839" points="762,317.8524,766.8,307.0524,762,311.8524,757.2,307.0524,762,317.8524" style="stroke: #73A839; stroke-width: 3.0;"/><line style="stroke: #73A839; stroke-width: 3.0;" x1="762" x2="762" y1="311.8524" y2="302.2524"/><polygon fill="#00000000" points="762,64.536,757.2,71.736,762,78.936,766.8,71.736,762,64.536" style="stroke: #73A839; stroke-width: 3.0;"/><!--MD5=[7a910b07c96c7c18159a08bdf23f5fcf]
link FindReplyRMQ to EntryPoint--><path d="M92.752,427.2 C92.752,427.2 136.5454,427.2 157.0034,427.2 C167.2324,427.2 176.5316,427.2 183.6779,427.2 C184.5712,427.2 185.4308,427.2 186.2544,427.2 C186.6662,427.2 187.069,427.2 187.4625,427.2 C187.6593,427.2 187.8537,427.2 188.0458,427.2 C188.1418,427.2 188.2372,427.2 188.3321,427.2 " fill="none" id="FindReplyRMQ-EntryPoint" style="stroke: #2FA4E7; stroke-width: 3.0;"/><polygon fill="#2FA4E7" points="188.3321,427.2,177.5321,422.4,182.3321,427.2,177.5321,432,188.3321,427.2" style="stroke: #2FA4E7; stroke-width: 3.0;"/><polygon fill="#00000000" points="78.352,427.2,85.552,432,92.752,427.2,85.552,422.4,78.352,427.2" style="stroke: #2FA4E7; stroke-width: 3.0;"/><text fill="#343A40" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="69.6" x="102.984" y="380.5664">Consume</text><text fill="#343A40" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="28.8" x="123.384" y="397.3289">RPC</text><text fill="#343A40" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="31.2" x="122.184" y="414.0914">msg</text><path d="M165.4887,435.6853 A12,12 0 0 0 165.4887 418.7147" fill="#FFFFFF" style="stroke: #2FA4E7; stroke-width: 1.7999999999999998;"/><ellipse cx="157.0034" cy="427.2" fill="#FFFFFF" rx="7.2" ry="7.2" style="stroke: #2FA4E7; stroke-width: 1.7999999999999998;"/><!--MD5=[772798b0a77b593c46a83d9d01daa4be]
link MSG_C to GetCtx--><path d="M391.7712,570.3708 C393.9876,640.4304 397.8168,726.1524 404.4,802.8 C404.8644,808.2096 405.4248,813.8088 406.0416,819.426 " fill="none" id="MSG_C-&gt;GetCtx" style="stroke: #2FA4E7; stroke-width: 3.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#2FA4E7" points="406.7316,825.5196,410.285,814.2478,406.056,819.5578,400.7461,815.3287,406.7316,825.5196" style="stroke: #2FA4E7; stroke-width: 3.0;"/><text fill="#343A40" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="73.2" x="418.8" y="727.9664">Search Q.</text><text fill="#343A40" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="87.6" x="411.6" y="744.7289">Thread 1..N</text><!--MD5=[f1adc2b44053004af7124fd502d274f4]
link MSG_T to GetCtx--><path d="M768.5712,536.6496 C767.616,619.3932 752.55,731.0844 687.6,802.8 C665.8128,826.8564 637.2816,844.02 606.8976,856.2432 " fill="none" id="MSG_T-&gt;GetCtx" style="stroke: #73A839; stroke-width: 3.0;"/><polygon fill="#73A839" points="601.2048,858.468,613.0111,859.0076,606.7932,856.2841,609.5168,850.0662,601.2048,858.468" style="stroke: #73A839; stroke-width: 3.0;"/><text fill="#343A40" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="52.8" x="766.8" y="736.3664">Test Q.</text><!--MD5=[b6223a3a6390dc20fa00adcaa859a578]
link RetBet to GetCtx--><!--MD5=[047457c171c94be8065864a2166fa3de]
link GetCtx to GetVects--><path d="M415.2,948.1776 C415.2,954.9588 415.2,961.716 415.2,968.088 " fill="none" id="GetCtx-&gt;GetVects" style="stroke: #868E96; stroke-width: 3.0;"/><polygon fill="#868E96" points="415.2,974.3172,420,963.5172,415.2,968.3172,410.4,963.5172,415.2,974.3172" style="stroke: #868E96; stroke-width: 3.0;"/><!--MD5=[62895d07cdb544a06ce13b735ba82e7a]
link GetVects to AskFaiss--><path d="M415.2,1039.524 C415.2,1045.7868 415.2,1052.5176 415.2,1059.2556 " fill="none" id="GetVects-&gt;AskFaiss" style="stroke: #868E96; stroke-width: 3.0;"/><polygon fill="#868E96" points="415.2,1065.4332,420,1054.6332,415.2,1059.4332,410.4,1054.6332,415.2,1065.4332" style="stroke: #868E96; stroke-width: 3.0;"/><!--MD5=[c37a44f2f5b3f10a24b8bd2687bbbcc8]
link AskFaiss to GetVectAdm--><path d="M415.2,1159.4664 C415.2,1166.0868 415.2,1172.8368 415.2,1179.2688 " fill="none" id="AskFaiss-&gt;GetVectAdm" style="stroke: #868E96; stroke-width: 3.0;"/><polygon fill="#868E96" points="415.2,1185.5808,420,1174.7808,415.2,1179.5808,410.4,1174.7808,415.2,1185.5808" style="stroke: #868E96; stroke-width: 3.0;"/><!--MD5=[1813dca5fe309a935a680031668006e9]
link GetVectAdm to getBestMatching--><path d="M421.3212,1250.5236 C422.6232,1257.186 424.0308,1264.3932 425.4384,1271.5944 " fill="none" id="GetVectAdm-&gt;getBestMatching" style="stroke: #868E96; stroke-width: 3.0;"/><polygon fill="#868E96" points="426.618,1277.6304,429.2552,1266.1098,425.466,1271.742,419.8338,1267.9529,426.618,1277.6304" style="stroke: #868E96; stroke-width: 3.0;"/><!--MD5=[06877c503610f9ba5727f110a1c60292]
reverse link RetBet to getBestMatching--><path d="M625.8396,768.57 C646.0128,798.3744 669.6,842.4468 669.6,885.6 C669.6,885.6 669.6,885.6 669.6,1219.2 C669.6,1253.4528 648.4296,1276.5468 618.8256,1292.0928 " fill="none" id="RetBet&lt;-getBestMatching" style="stroke: #868E96; stroke-width: 3.0;"/><polygon fill="#868E96" points="622.3788,763.5444,624.5499,775.1619,625.7814,768.4863,632.457,769.7177,622.3788,763.5444" style="stroke: #868E96; stroke-width: 3.0;"/><!--MD5=[54ac080d62da3b07971dc3a0e89da4c2]
reverse link MSG_C to RetBet--><path d="M490.5912,575.2368 C522.6768,621.5208 555.0912,668.28 575.7012,698.0112 " fill="none" id="MSG_C&lt;-RetBet" style="stroke: #2FA4E7; stroke-width: 3.0;"/><polygon fill="#2FA4E7" points="487.086,570.18,489.293,581.7907,490.5038,575.1114,497.1832,576.3222,487.086,570.18" style="stroke: #2FA4E7; stroke-width: 3.0;"/><!--MD5=[dbb8e5923775c1c1eaf4b80534072436]
reverse link MSG_T to RetBet--><path d="M699.9324,542.1156 C669.3372,598.17 634.776,661.4892 614.6652,698.3352 " fill="none" id="MSG_T&lt;-RetBet" style="stroke: #73A839; stroke-width: 3.0;"/><polygon fill="#73A839" points="702.8796,536.7144,693.4934,543.8963,700.006,541.9815,701.9208,548.4941,702.8796,536.7144" style="stroke: #73A839; stroke-width: 3.0;"/><!--MD5=[17bf6e70bd950cfc4d74cb02577c3d96]
link Admin1 to GetCtx--><path d="M146.7,886.8 C168.81,886.8 214.3308,886.8 214.3308,886.8 " fill="none" id="Admin1-GetCtx" style="stroke: #2FA4E7; stroke-width: 3.0;"/><polygon fill="#00000000" points="228.7308,886.8,221.5308,882,214.3308,886.8,221.5308,891.6,228.7308,886.8" style="stroke: #2FA4E7; stroke-width: 3.0;"/><polygon fill="#2FA4E7" points="131.0568,886.8,141.8568,891.6,137.0568,886.8,141.8568,882,131.0568,886.8" style="stroke: #2FA4E7; stroke-width: 3.0;"/><line style="stroke: #2FA4E7; stroke-width: 3.0;" x1="137.0568" x2="146.6568" y1="886.8" y2="886.8"/><!--MD5=[9b0615f058061e7be644c4c3710bd288]
link Encoder to GetVects--><path d="M133.962,1006.8 C165.9996,1006.8 245.8584,1006.8 245.8584,1006.8 " fill="none" id="Encoder-GetVects" style="stroke: #2FA4E7; stroke-width: 3.0;"/><polygon fill="#00000000" points="260.2584,1006.8,253.0584,1002,245.8584,1006.8,253.0584,1011.6,260.2584,1006.8" style="stroke: #2FA4E7; stroke-width: 3.0;"/><polygon fill="#2FA4E7" points="117.9131,1006.8,128.7131,1011.6,123.9131,1006.8,128.7131,1002,117.9131,1006.8" style="stroke: #2FA4E7; stroke-width: 3.0;"/><line style="stroke: #2FA4E7; stroke-width: 3.0;" x1="123.9131" x2="133.5132" y1="1006.8" y2="1006.8"/><text fill="#343A40" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="38.4" x="169.8" y="976.9664">Send</text><text fill="#343A40" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="92.4" x="142.8" y="993.7289">RPC request</text><path d="M210.4096,1015.2853 A12,12 0 0 0 210.4096 998.3147" fill="#FFFFFF" style="stroke: #2FA4E7; stroke-width: 1.7999999999999998;"/><ellipse cx="201.9243" cy="1006.8" fill="#FFFFFF" rx="7.2" ry="7.2" style="stroke: #2FA4E7; stroke-width: 1.7999999999999998;"/><!--MD5=[c82c8146aee7f8fa2805a5fe9c1ce465]
link Faiss to AskFaiss--><path d="M146.994,1112.4 C158.466,1112.4 182.652,1112.4 182.652,1112.4 " fill="none" id="Faiss-AskFaiss" style="stroke: #2FA4E7; stroke-width: 3.0;"/><polygon fill="#00000000" points="197.052,1112.4,189.852,1107.6,182.652,1112.4,189.852,1117.2,197.052,1112.4" style="stroke: #2FA4E7; stroke-width: 3.0;"/><polygon fill="#2FA4E7" points="130.9968,1112.4,141.7968,1117.2,136.9968,1112.4,141.7968,1107.6,130.9968,1112.4" style="stroke: #2FA4E7; stroke-width: 3.0;"/><line style="stroke: #2FA4E7; stroke-width: 3.0;" x1="136.9968" x2="146.5968" y1="1112.4" y2="1112.4"/><!--MD5=[57ae039b23fbf6a8d6f4e71fc269894a]
link Admin2 to GetVectAdm--><path d="M146.8128,1218 C165.5436,1218 204.342,1218 204.342,1218 " fill="none" id="Admin2-GetVectAdm" style="stroke: #2FA4E7; stroke-width: 3.0;"/><polygon fill="#00000000" points="218.742,1218,211.542,1213.2,204.342,1218,211.542,1222.8,218.742,1218" style="stroke: #2FA4E7; stroke-width: 3.0;"/><polygon fill="#2FA4E7" points="131.0568,1218,141.8568,1222.8,137.0568,1218,141.8568,1213.2,131.0568,1218" style="stroke: #2FA4E7; stroke-width: 3.0;"/><line style="stroke: #2FA4E7; stroke-width: 3.0;" x1="137.0568" x2="146.6568" y1="1218" y2="1218"/><!--MD5=[0c71eff58df83eceeaf53b07c9051436]
link Matcher to getBestMatching--><path d="M126.4711,1324.8 C156.8748,1324.8 237.9696,1324.8 237.9696,1324.8 " fill="none" id="Matcher-getBestMatching" style="stroke: #2FA4E7; stroke-width: 3.0;"/><polygon fill="#00000000" points="252.3696,1324.8,245.1696,1320,237.9696,1324.8,245.1696,1329.6,252.3696,1324.8" style="stroke: #2FA4E7; stroke-width: 3.0;"/><polygon fill="#2FA4E7" points="110.5225,1324.8,121.3225,1329.6,116.5225,1324.8,121.3225,1320,110.5225,1324.8" style="stroke: #2FA4E7; stroke-width: 3.0;"/><line style="stroke: #2FA4E7; stroke-width: 3.0;" x1="116.5225" x2="126.1225" y1="1324.8" y2="1324.7999"/><text fill="#343A40" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="38.4" x="162.3" y="1294.9664">Send</text><text fill="#343A40" font-family="Verdana" font-size="14.4" lengthAdjust="spacingAndGlyphs" textLength="92.4" x="135.3" y="1311.7289">RPC request</text><path d="M202.107,1333.2853 A12,12 0 0 0 202.107 1316.3147" fill="#FFFFFF" style="stroke: #2FA4E7; stroke-width: 1.7999999999999998;"/><ellipse cx="193.6217" cy="1324.8" fill="#FFFFFF" rx="7.2" ry="7.2" style="stroke: #2FA4E7; stroke-width: 1.7999999999999998;"/><!--MD5=[c4cd68332274bed775a6af0e456b8d18]
@startuml FindReply_Full




skinparam backgroundColor White








skinparam defaultFontName       "Verdana"
skinparam defaultFontSize       12
skinparam dpi                   100
skinparam shadowing             True
skinparam roundcorner           8
skinparam ParticipantPadding    40
skinparam BoxPadding            40
skinparam Padding               5
skinparam ArrowColor            #868E96
skinparam stereotype {
    CBackgroundColor #EDF0F2
    CBorderColor #BABDBF
    ABackgroundColor #8FB961
    ABorderColor $SUCCESS_DARK
    IBackgroundColor #D2494E
    IBorderColor $DANGER_DARK
    EBackgroundColor #E47833
    EBorderColor $WARNING_DARK
    NBackgroundColor #35638F
    NBorderColor $INFO_DARK
}
skinparam title {
	FontColor	                 #2FA4E7
	BorderColor	                 #BABDBF
	FontSize	    	         20
	BorderRoundCorner            8
	BorderThickness 	         1
	BackgroundColor              White
}

skinparam legend {
	BackgroundColor White
	BorderColor #BABDBF
	FontColor #343A40
}


skinparam activity {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
	BarColor #73A839
	StartColor #033C73
	EndColor #033C73
	DiamondBackgroundColor White
  	DiamondBorderColor #BABDBF
	DiamondFontColor #BABDBF
}


skinparam participant {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
	ParticipantBorderThickness 2
}


skinparam actor {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
}


skinparam arrow {
	Thickness 2.5
	Color #2FA4E7
	FontColor #343A40
}


skinparam sequence {
	BorderColor #2FA4E7
	TitleFontColor #2FA4E7
	BackgroundColor White
	StartColor #2FA4E7
	EndColor #2FA4E7
	BoxBackgroundColor White
	BoxBorderColor #868E96
	BoxFontColor #343A40
	LifeLineBorderColor #BABDBF
	LifeLineBorderThickness 2
	LifeLineBackgroundColor White
	GroupBorderColor #868E96
	GroupFontColor #343A40
	GroupHeaderFontColor #033C73
	DividerBackgroundColor White
    DividerBorderColor #868E96
    DividerBorderThickness 2
    DividerFontColor #343A40
	ReferenceBackgroundColor White
	ReferenceBorderColor #868E96
	ReferenceFontColor #343A40
	ReferenceHeaderFontColor #033C73
}


skinparam partition {
	BorderColor #2FA4E7
	FontColor #2FA4E7
	BackgroundColor White
}


skinparam collections {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
}


skinparam control {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
}


skinparam entity {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
}


skinparam boundary {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
}


skinparam agent {
	BackgroundColor White
	BorderColor #999999
	FontColor #333333
}


skinparam note {
	BorderThickness 1
	BackgroundColor White
	BorderColor #033C73
	FontColor #033C73
}


skinparam artifact {
	BackgroundColor White
	BorderColor #868E96
	FontColor #868E96
}


skinparam component {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
	
}


skinparam interface {
	BackgroundColor  White
	BorderColor  #C71C22
	FontColor #343A40
}


skinparam storage {
	BackgroundColor White
  	BorderColor #DD5600
	FontColor #DD5600
}


skinparam node {
	BackgroundColor White
	BorderColor #343A40
	FontColor #343A40
}


skinparam cloud {
	BackgroundColor #F2FCFE-#eeeeee
	BorderColor #F2FCFE
	FontColor #343A40
}


skinparam database {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
}


skinparam class {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
	HeaderBackgroundColor #2FA4E7-#2683B9
	StereotypeFontColor #343A40
	BorderThickness 1
	AttributeFontColor #343A40
	AttributeFontSize 11
}


skinparam object {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
	StereotypeFontColor #343A40
	BorderThickness 1
	AttributeFontColor #BABDBF
	AttributeFontSize 11
}


skinparam usecase {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
	BorderThickness 2
	StereotypeFontColor #2FA4E7
}


skinparam rectangle {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
	BorderThickness 2
	StereotypeFontColor #2FA4E7
}


skinparam package {
	BackgroundColor #F2FCFE-#eeeeee
  	BorderColor #033C73
	FontColor #033C73
	BorderThickness 2
}


skinparam folder {
	BackgroundColor White
  	BorderColor #DD5600
	FontColor #DD5600
	BorderThickness 2
}


skinparam frame {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
	BorderThickness 2
	StereotypeFontColor #2FA4E7
}



skinparam state {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
	StartColor #033C73
	EndColor #033C73
	AttributeFontColor #BABDBF
	AttributeFontSize 11
}


skinparam queue {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
}


skinparam card {
	BackgroundColor White
	BorderColor #033C73
	FontColor #033C73
}


skinparam file {
	BackgroundColor White
	BorderColor #868E96
	FontColor #868E96
}


skinparam stack {
		FontColor #2683B9
	BorderColor #2683B9
	BackgroundColor White
}



hide stereotype

skinparam backgroundColor transparent
!pragma horizontalLineBetweenDifferentPackageAllowed

skinparam file<<NOTE>> {
	BorderThickness 0.5
    BackgroundColor LightYellow
	BorderColor LightSteelBlue
	FontColor SteelBlue
    FontSize 10
    ArrowColor LightSteelBlue
}
skinparam arrow<<NOTE>> {
    Color LightSteelBlue
}





skinparam node<<MULTITHREADED>>{
    FontColor #E47833
	BorderColor #E47833
	BackgroundColor White
	BorderThickness 2
	StereotypeFontColor #2FA4E7
}


skinparam package<<CONTAINER>>{
    	BackgroundColor #eeeeee
  	BorderColor #033C73
	FontColor #033C73
	BorderThickness 2
}
skinparam frame<<CONTAINER>>{
    	BackgroundColor #eeeeee
  	BorderColor #033C73
	FontColor #033C73
	BorderThickness 2
}


skinparam rectangle<<boundary>> {
    BackgroundColor #eeeeee
    Shadowing false
    StereotypeFontSize 0
    FontColor #444444
    BorderColor #444444
    BorderStyle dashed
    BoxPadding 0
}

skinparam file<<docker_params>> {
    Shadowing True
    FontSize 10
}












skinparam nodesep 30
skinparam ranksep 20
skinparam componentStyle uml2

skinparam Entity<<ADMIN>>{
    FontColor black
	BorderColor #6F42C1
	BackgroundColor #Red/Yellow
}
skinparam Entity<<FAISS>>{
    FontColor black
	BorderColor #6F42C1
	BackgroundColor #Blue/White
}
skinparam arrow<<TEST>> {
	Thickness 1
	Color #73A839
	FontColor #343A40
}

skinparam arrow<<INTRA>> {
	Color #868E96
}


scale 1.2
interface "<b>Start Here</b>" as FindReplyRMQ
interface "<b>Testings</b>" as TestFindings

Entity "Admin" <<ADMIN>> as Admin1
Entity "Admin" <<ADMIN>> as Admin2
Entity Faiss <<FAISS>>
Entity "Bert Encoder" as Encoder
Entity "Sentence\nMatching" as Matcher

    package FindReplyModule as FindReplyModule <<CONTAINER>> {
            rectangle "Docker Config" <<boundary>> as FindReplyModule_cfg {
                    

        file "- - =Variables - -\n==Mandatory\nRMQ_IP: <i>RMQ broker</i>,\n                                QUESTIONS_QUEUE = Questions from RASA\n                                Ex: tbott-rpc.<i>dom.proj</i>\n===Optional\nRMQ_USER = <i>tbott</i>\n                                RMQ_PASSWD = <i>M0m3n773ch</i>\n                                ENCODER_QUEUE = <i>tbott-encoder</i>\n                                MATCHING_QUEUE = <i>tbott-matching</i>\n                                NB_INSTANCES = <i>5</i>\n                                RMQ_PORT = <i>5672</i>\n                                LOG_LEVEL= <i>INFO</i>" <<docker_params>> as FindReplyModule_vars
                    

        file "- - =Volumes - -\n<b>logs</b> -> /var/log/supervisor" <<docker_params>> as FindReplyModule_vols
    
                FindReplyModule_vols -[hidden]U- FindReplyModule_vars
        } 
            frame "Internal Testing" as TestingInterface {
            component MSG_T [
                [[http://10.165.64.205/AI/Messaging Messaging]] lib
                - - - -
                <color:teal>zeromq.ThreadedWorker(</color>
                <color:teal>    <i>callback_func</i>,</color>
                <color:teal>    127.0.0.1,</color>
                <color:teal>    <b>14002</b></color>
                <color:teal>    <b>nb_workers=1</b>)</color>
                ]
        }
        TestFindings o-d-> MSG_T<<TEST>>

                node "Entry Point\n<i><font color=Teal>NB_INSTANCES</font></i> Threads" as EntryPoint <<MULTITHREADED>> {
            component MSG_C [
                [[http://10.165.64.205/AI/Messaging Messaging]] lib
                - - - -
                <i><color:teal>treaded_rpc.worker(</color></i>
                <i><color:teal>host=<b>$RMQ_IP</b></color></i>
                <i><color:teal>username=$RMQ_USER</color></i>
                <i><color:teal>password=$RMQ_PASSWD</color></i>
                <i><color:teal>rpc_queue=$QUESTION_QUEUE</color></i>
                <i><color:teal>port=$RMQ_PORT)</color></i>
                - - - -
                on_request(msg)
                ]
        }
        FindReplyRMQ o-r0)-> EntryPoint: Consume\nRPC\nmsg
    
        frame "Search Best" as SearchBest {
            [if type == "question":\n > get N1/N2 contexts @ 127.0.0.1:14001\n > extend question list] as GetCtx
            [get vectors @ $ENCODER_QUEUE] as GetVects
            [get candidates IDs from FAISS @ 127.0.0.1:14000\nrearange IDs] as AskFaiss
            [get IDs' <b>questions</b> and <b>replies</b> from Admin] as GetVectAdm
            [create list of paired vectors\nget best Matching @ $MATCHING_QUEUE] as getBestMatching
            [return best] as RetBet

        }
        MSG_C ..> GetCtx: "Search Q.\nThread 1..N"
            MSG_T - -> GetCtx<<TEST>>: "Test Q."

        RetBet -[hidden]-> GetCtx
        GetCtx -down-> GetVects<<INTRA>>
        GetVects -down-> AskFaiss<<INTRA>>
        AskFaiss -down-> GetVectAdm<<INTRA>>
        GetVectAdm -down-> getBestMatching<<INTRA>>
        getBestMatching -u-> RetBet<<INTRA>>

        RetBet -u-> MSG_C
            RetBet -u-> MSG_T<<TEST>>
            
        GetCtx o-l-> Admin1
        GetVects o-l0)-> Encoder: Send\nRPC request
        AskFaiss o-l-> Faiss
        GetVectAdm o-l-> Admin2
        getBestMatching o-l0)-> Matcher: Send\nRPC request


}
@enduml

PlantUML version 1.2020.08(Sun Apr 26 14:08:22 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_212-8u212-b01-1~deb9u1-b01
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>